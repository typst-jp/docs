{"route":"/docs/reference/introspection/state/","title":"State","description":"Documentation for the State type.","part":null,"outline":[{"id":"summary","name":"æ¦‚è¦","children":[]},{"id":"state-and-markup","name":"State And Markup","children":[]},{"id":"state-in-typst","name":"State In Typst","children":[]},{"id":"ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«","name":"ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«","children":[]},{"id":"caution","name":"Caution","children":[]},{"id":"constructor","name":"ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿","children":[{"id":"constructor-key","name":"key","children":[]},{"id":"constructor-init","name":"init","children":[]}]},{"id":"definitions","name":"å®šç¾©","children":[{"id":"definitions-get","name":"Get","children":[]},{"id":"definitions-at","name":"At","children":[{"id":"definitions-at-selector","name":"selector","children":[]}]},{"id":"definitions-final","name":"Final","children":[]},{"id":"definitions-update","name":"Update","children":[{"id":"definitions-update-update","name":"update","children":[]}]}]}],"body":{"kind":"type","content":{"name":"state","title":"State","keywords":[],"oneliner":"æ–‡æ›¸ä¸­ã®çŠ¶æ…‹ã®ç®¡ç†ã€‚","details":"<p>æ–‡æ›¸ä¸­ã®çŠ¶æ…‹ã®ç®¡ç†ã€‚</p>\n<p>æ–‡æ›¸ä¸­ã§ä½•å›ã‹è¨ˆç®—ã‚’è¡Œã„ã€æœ€å¾Œã®è¨ˆç®—çµæœã‚’æ¬¡ã®è¨ˆç®—ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã«è¨˜æ†¶ã—ã¦ãŠããŸã„ã¨ã—ã¾ã™ã€‚\nä»¥ä¸‹ã¨åŒç­‰ã®ã‚³ãƒ¼ãƒ‰ã‚’è©¦ã™ã¨10ã€13ã€26ã€21ã¨å‡ºåŠ›ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…ã™ã‚‹ã§ã—ã‚‡ã†ã€‚\nã—ã‹ã—Typstã§ã¯<strong>ãã†ã¯ãªã‚Šã¾ã›ã‚“</strong>ã€‚\nã“ã®ã‚³ãƒ¼ãƒ‰ã‚’è©¦ã—ã¦ã¿ã‚‹ã¨ã€Typstã¯ <em>Variables from outside the function are read-only and cannot be modified.</em> ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p>\n<pre><code><span class=\"typ-comment\">// This doesn&#39;t work!</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> star <span class=\"typ-op\">=</span> <span class=\"typ-num\">0</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span>expr<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-punct\">{</span>\n  star <span class=\"typ-op\">=</span> <span class=\"typ-func\">eval</span><span class=\"typ-punct\">(</span>\n    expr<span class=\"typ-punct\">.</span><span class=\"typ-func\">replace</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-func\">str</span><span class=\"typ-punct\">(</span>star<span class=\"typ-punct\">)</span><span class=\"typ-punct\">)</span>\n  <span class=\"typ-punct\">)</span>\n  <span class=\"typ-punct\">[</span>New value is <span class=\"typ-pol\">#</span><span class=\"typ-pol\">star</span>.<span class=\"typ-punct\">]</span>\n<span class=\"typ-punct\">}</span>\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;10&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ + 3&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ * 2&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ - 5&quot;</span><span class=\"typ-punct\">)</span>\n</code></pre>\n<h2 id=\"state-and-markup\">çŠ¶æ…‹ã¨æ–‡æ›¸ã®ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—</h2>\n<p>ãªãœã“ã†ãªã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ\nä¸€èˆ¬çš„ã«å‰¯ä½œç”¨ã‚’ä¼´ã†ã“ã®æ‰‹ã®è¨ˆç®—ã¯æ–‡æ›¸ã®ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ã«ãŠã„ã¦å•é¡Œã‚’å¼•ãèµ·ã“ã™ãŸã‚ã§ã€Typstã§ã¯ã“ã‚Œã‚’ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚\nã“ã®çµæœã‚’ç†è§£ã™ã‚‹ã«ã¯ã€è¨ˆç®—å‡¦ç†ãŒæ–‡æ›¸å†…ã§ç”Ÿæˆç‰©ãŒãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹é †åºã¨åŒã˜é †åºã§è¡Œã‚ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nä»Šå›ã®å˜ç´”ãªä¾‹ã§ã¯ã“ã®æ¡ä»¶ãŒæº€ãŸã•ã‚Œã¾ã™ãŒã€ä¸€èˆ¬çš„ã«ã¯å¿…ãšã—ã‚‚ãã†ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚</p>\n<p>è¦‹å‡ºã—ã®ç•ªå·ä»˜ã‘ã¨ã„ã†ã€é¡ä¼¼ã—ãŸçŠ¶æ…‹ã§ã™ãŒã€å°‘ã—ç•°ãªã‚‹ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\nå„è¦‹å‡ºã—ã§è¦‹å‡ºã—ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®å€¤ã‚’å¢—ã‚„ã—ãŸã„ã¨ã—ã¾ã™ã€‚\nç°¡å˜ãã†ã§ã™ã‚ˆã­ï¼Ÿ\nãŸã 1ã‚’è¶³ã™ã ã‘ã§ã™ã€‚\næ®‹å¿µãªãŒã‚‰ãã†å˜ç´”ã§ã¯ãªã„ã®ã§ã™ã€‚\nä»¥ä¸‹ã®ä¾‹ã‚’è€ƒãˆã¾ã™ã€‚</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">heading</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;1.&quot;</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">template</span><span class=\"typ-punct\">(</span>body<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-punct\">[</span>\n  <span class=\"typ-heading\">= Outline</span>\n  <span class=\"typ-escape\">...</span>\n  <span class=\"typ-pol\">#</span><span class=\"typ-pol\">body</span>\n<span class=\"typ-punct\">]</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">show</span><span class=\"typ-punct\">:</span> <span class=\"typ-func\">template</span>\n\n<span class=\"typ-heading\">= Introduction</span>\n<span class=\"typ-escape\">...</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/382f18a61cf8fa6150847e8c9bd970c0.png\" alt=\"Preview\"></div></div>\n<p>ã“ã“ã§ã€Typstã¯ã¾ãšshowãƒ«ãƒ¼ãƒ«ä»¥é™ã®æ–‡æ›¸æœ¬ä½“ã‚’å‡¦ç†ã—ã€<code>Introduction</code>è¦‹å‡ºã—ã‚’æ¤œçŸ¥ã—ã¾ã™ã€‚\nç¶šã„ã¦<code>template</code>é–¢æ•°ã«ç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ¸¡ã—ã¾ã™ã€‚\nãã®å¾Œã€åˆã‚ã¦<code>Outline</code>ã‚’æ¤œçŸ¥ã—ã¾ã™ã€‚\nå˜ã«ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å€¤ã‚’å¢—ã‚„ã™ã¨<code>Introduction</code>ã¯<code>1</code>ã«ã€<code>Outline</code>ã¯<code>2</code>ã¨ãªã‚Šã¾ã™ã€‚</p>\n<h2 id=\"state-in-typst\">Typstã«ãŠã‘ã‚‹çŠ¶æ…‹ç®¡ç†</h2>\n<p>ãã‚Œã§ã¯ä»£ã‚ã‚Šã«ã©ã†ã™ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ\nTypstã®çŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nè­˜åˆ¥ç”¨ã®ã‚­ãƒ¼ã¨ãªã‚‹æ–‡å­—åˆ—ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®åˆæœŸå€¤ã¨ã¨ã‚‚ã«<code>state</code>é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§çŠ¶æ…‹å€¤ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚\nã“ã®çŠ¶æ…‹å€¤ã¯ã„ãã¤ã‹ã®é–¢æ•°ã‚’å…¬é–‹ã—ã¦ãŠã‚Šã€æœ€ã‚‚é‡è¦ãª2ã¤ã®é–¢æ•°ãŒ<code>get</code>ã¨<code>update</code>ã§ã™ã€‚</p>\n<ul>\n<li>\n<p><a href=\"/docs/reference/introspection/state/#definitions-get\"><code>get</code></a>é–¢æ•°ã¯çŠ¶æ…‹ã®ç¾åœ¨å€¤ã‚’å–å¾—ã—ã¾ã™ã€‚\nå€¤ã¯æ–‡æ›¸ä¸­ã§å¤‰åŒ–ã™ã‚‹ãŸã‚ã€ã“ã‚Œã¯<a href=\"/docs/reference/context/\">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</a>ãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆã«ã®ã¿ä½¿ç”¨ã§ãã‚‹ <em>ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</em> é–¢æ•°ã§ã™ã€‚</p>\n</li>\n<li>\n<p><a href=\"/docs/reference/introspection/state/#definitions-update\"><code>update</code></a>é–¢æ•°ã¯çŠ¶æ…‹ã«ä¿®æ­£ã‚’åŠ ãˆã¾ã™ã€‚\nä»»æ„ã®å€¤ãŒä½¿ç”¨ã§ãã¾ã™ã€‚\né–¢æ•°ã§ã¯ãªã„å€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã€çŠ¶æ…‹ã«ãã®å€¤ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚\né–¢æ•°ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€ãã®é–¢æ•°ã¯å‰ã®çŠ¶æ…‹ã‚’å—ã‘å–ã‚Šã€æ–°ã—ã„çŠ¶æ…‹ã‚’è¿”ã•ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</p>\n</li>\n</ul>\n<p>æœ€åˆã®ä¾‹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> star <span class=\"typ-op\">=</span> <span class=\"typ-func\">state</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;star&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-num\">0</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span>expr<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-punct\">{</span>\n  star<span class=\"typ-punct\">.</span><span class=\"typ-func\">update</span><span class=\"typ-punct\">(</span>old <span class=\"typ-op\">=&gt;</span>\n    <span class=\"typ-func\">eval</span><span class=\"typ-punct\">(</span>expr<span class=\"typ-punct\">.</span><span class=\"typ-func\">replace</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-func\">str</span><span class=\"typ-punct\">(</span>old<span class=\"typ-punct\">)</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">)</span>\n  <span class=\"typ-punct\">)</span>\n  <span class=\"typ-punct\">[</span>New value is <span class=\"typ-key\">#</span><span class=\"typ-key\">context</span> star<span class=\"typ-punct\">.</span><span class=\"typ-func\">get</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>.<span class=\"typ-punct\">]</span>\n<span class=\"typ-punct\">}</span>\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;10&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ + 3&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ * 2&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ - 5&quot;</span><span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/90558dbee771e808eca1f68cdf3a9180.png\" alt=\"Preview\"></div></div>\n<p>TypstãŒç®¡ç†ã™ã‚‹çŠ¶æ…‹ã¯å¸¸ã«è©•ä¾¡é †ã§ã¯ãªããƒ¬ã‚¤ã‚¢ã‚¦ãƒˆé †ã§æ›´æ–°ã•ã‚Œã¾ã™ã€‚\n<code>update</code>ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¿”ã—ã€ãã®å½±éŸ¿ã¯æ–‡æ›¸ã«è¿”ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒæŒ¿å…¥ã•ã‚ŒãŸå ´æ‰€ã§ç”Ÿã˜ã¾ã™ã€‚</p>\n<p>ã“ã®ã‚ˆã†ã«ã—ã¦ã€è¨ˆç®—çµæœã‚’å¤‰æ•°ã«ä¿å­˜ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€æ­£ã—ã„çµæœã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-escape\">...</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> more <span class=\"typ-op\">=</span> <span class=\"typ-punct\">[</span>\n  <span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ * 2&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n  <span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ - 5&quot;</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-punct\">]</span>\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;10&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ + 3&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-pol\">#</span><span class=\"typ-pol\">more</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/60d834289ed95a6cd0ead55e970b8e94.png\" alt=\"Preview\"></div></div>\n<p>ã“ã®ä¾‹ã¯ã‚‚ã¡ã‚ã‚“å°‘ã€…æ¥µç«¯ã§ã™ãŒã€ã“ã‚ŒãŒå®Ÿéš›ã«æœ¬å½“ã«å¿…è¦ã¨ãªã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ï¼\nè‰¯ã„ä¾‹ã¯è¦‹å‡ºã—ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã§ã™ã€‚\nã“ã‚Œã¯Typstã®<a href=\"/docs/reference/introspection/counter/\">ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚·ã‚¹ãƒ†ãƒ </a>ãŒçŠ¶æ…‹ã‚·ã‚¹ãƒ†ãƒ ã«ã¨ã¦ã‚‚ã‚ˆãä¼¼ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚</p>\n<h2 id=\"ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«\">ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«</h2>\n<p>Typstã®çŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«ã‚‚ã§ãã¾ã™ï¼\næ–‡æ›¸å†…ã®ä»»æ„ã®ä½ç½®ã§ãã®çŠ¶æ…‹ãŒã©ã®å€¤ã«ãªã£ã¦ã„ã‚‹ã®ã‹ã‚’ã€ã©ã“ã‹ã‚‰ã§ã‚‚çªãæ­¢ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nç‰¹ã«ã€<code>at</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã¨ç‰¹å®šã®ä»»æ„ã®ä½ç½®ã§ã®çŠ¶æ…‹å€¤ãŒå–å¾—ã§ãã€<code>final</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã¨æ–‡æ›¸ã®çµ‚ã‚ã‚Šã§ã®çŠ¶æ…‹å€¤ã‚’å–å¾—ã§ãã¾ã™ã€‚</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-escape\">...</span>\n\nValue at <span class=\"typ-raw\">`&lt;here&gt;`</span> is\n<span class=\"typ-key\">#</span><span class=\"typ-key\">context</span> star<span class=\"typ-punct\">.</span><span class=\"typ-func\">at</span><span class=\"typ-punct\">(</span><span class=\"typ-label\">&lt;here&gt;</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;10&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ + 3&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-strong\">*Here.*</span> <span class=\"typ-label\">&lt;here&gt;</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ * 2&quot;</span><span class=\"typ-punct\">)</span> <span class=\"typ-escape\">\\</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">compute</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;â­ - 5&quot;</span><span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/51ba9ea8959d58ae8865d48419e2a96e.png\" alt=\"Preview\"></div></div>\n<h2 id=\"caution\">æ³¨æ„äº‹é …</h2>\n<p>å…¨ã¦ã®çŠ¶æ…‹å€¤ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€Typstã¯ã‚³ãƒ¼ãƒ‰ã‚’è¤‡æ•°å›è©•ä¾¡ã—ã¾ã™ã€‚\nã—ã‹ã—ãªãŒã‚‰ã€å®Ÿéš›ã«çŠ¶æ…‹æ“ä½œãŒå®Œå…¨ã«è§£æ±ºã•ã‚Œã‚‹ã‹ã¯ä¿è¨¼ã•ã‚Œã¾ã›ã‚“ã€‚</p>\n<p>ä¾‹ãˆã°ã€çŠ¶æ…‹ã®æœ€çµ‚çš„ãªå€¤ã«ä¾å­˜ã™ã‚‹æ›´æ–°ã‚’è¡Œã†çŠ¶æ…‹ã‚’ä½œæˆã—ãŸå ´åˆã€æ±ºã—ã¦åæŸã—ãªããªã‚‹ã§ã—ã‚‡ã†ã€‚\nä»¥ä¸‹ã®ä¾‹ã¯ã“ã®å®Ÿæ¼”ã§ã™ã€‚\nçŠ¶æ…‹ã‚’<code>1</code>ã§åˆæœŸåŒ–ã—ã€ç¶šã„ã¦è‡ªèº«ã®æœ€çµ‚å€¤ã«1ã‚’è¶³ã—ãŸå€¤ã«æ›´æ–°ã—ã¾ã™ã€‚\nã—ãŸãŒã£ã¦å€¤ã¯<code>2</code>ã«ãªã‚‹ã¹ãã§ã™ãŒã€æœ€çµ‚å€¤ãŒ<code>2</code>ã¨ãªã£ãŸã®ã§<code>3</code>ã«æ›´æ–°ã—ã¾ã™ã€‚ä»¥ä¸‹åŒæ§˜ã§ã™ã€‚\nã“ã®ä¾‹ã§ã¯æœ‰é™å€¤ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ãŒã€ã“ã‚Œã¯å˜ã«TypstãŒæ•°å›è©¦è¡Œã—ãŸå¾Œã«è«¦ã‚ã‚‹ãŸã‚ã§ã™ã€‚</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-comment\">// This is bad!</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> x <span class=\"typ-op\">=</span> <span class=\"typ-func\">state</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;key&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-num\">1</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">context</span> x<span class=\"typ-punct\">.</span><span class=\"typ-func\">update</span><span class=\"typ-punct\">(</span>x<span class=\"typ-punct\">.</span><span class=\"typ-func\">final</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span> <span class=\"typ-op\">+</span> <span class=\"typ-num\">1</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">context</span> x<span class=\"typ-punct\">.</span><span class=\"typ-func\">get</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/353191d880395aa736697d1ec67de606.png\" alt=\"Preview\"></div></div>\n<p>ä¸€èˆ¬ã«ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†…éƒ¨ã§æ›´æ–°ã‚’è¡Œã†çŠ¶æ…‹ã‚’ä½œæˆã—ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚\nå¯èƒ½ã§ã‚ã‚Œã°ã€æ›´æ–°å†…å®¹ã‚’ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ä¾å­˜ã—ãªã„å€¤ã¨ã—ã¦ã€ã‚ã‚‹ã„ã¯å‰ã®å€¤ã‹ã‚‰æ–°ã—ã„å€¤ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°ã¨ã—ã¦å®šç¾©ã—ã¦ãã ã•ã„ã€‚\nã©ã†ã—ã¦ã‚‚é¿ã‘ã‚‰ã‚Œãªã„å ´åˆãŒã‚ã‚Šã¾ã™ãŒã€ãã®å ´åˆã¯çµæœãŒé©åˆ‡ã«åæŸã™ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ã“ã¨ã¯ã‚ãªãŸã®è²¬ä»»ã§ã™ã€‚</p>","constructor":{"path":[],"name":"state","title":"Construct","keywords":[],"oneliner":"ã‚­ãƒ¼ã§è­˜åˆ¥ã•ã‚Œã‚‹æ–°ã—ã„çŠ¶æ…‹ã®ä½œæˆã€‚","element":false,"contextual":false,"deprecationMessage":null,"deprecationUntil":null,"details":[{"kind":"html","content":"<p>ã‚­ãƒ¼ã§è­˜åˆ¥ã•ã‚Œã‚‹æ–°ã—ã„çŠ¶æ…‹ã®ä½œæˆã€‚</p>"}],"self":false,"params":[{"name":"key","details":[{"kind":"html","content":"<p>çŠ¶æ…‹ã‚’è­˜åˆ¥ã™ã‚‹ã‚­ãƒ¼ã€‚</p>\n<p>ã“ã®æ–‡å­—åˆ—ã‚­ãƒ¼ã§ã€çŠ¶æ…‹ã¸ã®<a href=\"/docs/reference/introspection/state/#definitions-update\">æ›´æ–°</a>ãŒè­˜åˆ¥ã•ã‚Œã¾ã™ã€‚\nåŒã˜<code>key</code>ã§è¤‡æ•°ã®çŠ¶æ…‹ã‚’ä½œã‚‹ã¨ã€ã©ã‚Œã‚’æ›´æ–°ã—ã¦ã‚‚åŒã˜çŠ¶æ…‹ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚</p>"}],"types":["str"],"strings":[],"default":null,"positional":true,"named":false,"required":true,"variadic":false,"settable":false},{"name":"init","details":[{"kind":"html","content":"<p>çŠ¶æ…‹ã®åˆæœŸå€¤ã€‚</p>\n<p>åŒã˜<code>key</code>ã§ã‚‚<code>init</code>ãŒç•°ãªã‚‹å ´åˆã€å„çŠ¶æ…‹ã¯è‡ªåˆ†ã®åˆæœŸå€¤ã‚’ä½¿ã„ã¾ã™ãŒã€\næ›´æ–°ã¯å…±æœ‰ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ã‚ã‚‹å ´æ‰€ã§ã®çŠ¶æ…‹å€¤ã¯ã€ãã®çŠ¶æ…‹ã®åˆæœŸå€¤ã¨\nãã‚Œä»¥å‰ã®æ›´æ–°ã‹ã‚‰è¨ˆç®—ã•ã‚Œã¾ã™ã€‚</p>"},{"kind":"example","content":{"body":"<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> banana <span class=\"typ-op\">=</span> <span class=\"typ-func\">state</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;key&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-str\">&quot;ğŸŒ&quot;</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> broccoli <span class=\"typ-op\">=</span> <span class=\"typ-func\">state</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;key&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-str\">&quot;ğŸ¥¦&quot;</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-pol\">#</span><span class=\"typ-pol\">banana</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">update</span><span class=\"typ-punct\">(</span>it <span class=\"typ-op\">=&gt;</span> it <span class=\"typ-op\">+</span> <span class=\"typ-str\">&quot;ğŸ˜‹&quot;</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">context</span> <span class=\"typ-punct\">[</span>\n  <span class=\"typ-marker\">-</span> <span class=\"typ-func\">#</span><span class=\"typ-func\">state</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;key&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-str\">&quot;ğŸ&quot;</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">get</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n  <span class=\"typ-marker\">-</span> <span class=\"typ-pol\">#</span><span class=\"typ-pol\">banana</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">get</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n  <span class=\"typ-marker\">-</span> <span class=\"typ-pol\">#</span><span class=\"typ-pol\">broccoli</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">get</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-punct\">]</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/9f5105246e9a16db3f675ecc36607343.png\" alt=\"Preview\"></div></div>","title":null}}],"types":["any"],"strings":[],"default":"<code><span class=\"typ-key\">none</span></code>","positional":true,"named":false,"required":false,"variadic":false,"settable":false}],"returns":["state"],"scope":[]},"scope":[{"path":["state"],"name":"get","title":"Get","keywords":[],"oneliner":"ç¾åœ¨ã®ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®çŠ¶æ…‹å€¤ã‚’å–å¾—ã€‚","element":false,"contextual":true,"deprecationMessage":null,"deprecationUntil":null,"details":[{"kind":"html","content":"<p>ç¾åœ¨ã®ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®çŠ¶æ…‹å€¤ã‚’å–å¾—ã€‚</p>\n<p>ã“ã‚Œã¯<code>state<span class=\"typ-punct\">.</span><span class=\"typ-func\">at</span><span class=\"typ-punct\">(</span><span class=\"typ-func\">here</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">)</span></code>ã¨ç­‰ä¾¡ã§ã™ã€‚</p>"}],"self":true,"params":[],"returns":["any"],"scope":[]},{"path":["state"],"name":"at","title":"At","keywords":[],"oneliner":"æŒ‡å®šã—ãŸã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã§ä¸€æ„ã«ç‰¹å®šã•ã‚Œã‚‹å¯¾è±¡ã®çŠ¶æ…‹å€¤ã‚’å–å¾—ã€‚","element":false,"contextual":true,"deprecationMessage":null,"deprecationUntil":null,"details":[{"kind":"html","content":"<p>æŒ‡å®šã—ãŸã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã§ä¸€æ„ã«ç‰¹å®šã•ã‚Œã‚‹å¯¾è±¡ã®çŠ¶æ…‹å€¤ã‚’å–å¾—ã€‚</p>\n<p><code>selector</code>ã¯æ–‡æ›¸ä¸­ã§å³å¯†ã«1ã¤ã ã‘ã®è¦ç´ ã«ãƒãƒƒãƒã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚\nã“ã®ç›®çš„ã§æœ€ã‚‚ä¾¿åˆ©ãªã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã¯<a href=\"/docs/reference/foundations/label/\">ãƒ©ãƒ™ãƒ«</a>ã¨<a href=\"/docs/reference/introspection/location/\">ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³</a>ã§ã™ã€‚</p>"}],"self":true,"params":[{"name":"selector","details":[{"kind":"html","content":"<p>çŠ¶æ…‹å€¤ã‚’å–å¾—ã™ã‚‹å ´æ‰€ã€‚</p>"}],"types":["label","selector","location","function"],"strings":[],"default":null,"positional":true,"named":false,"required":true,"variadic":false,"settable":false}],"returns":["any"],"scope":[]},{"path":["state"],"name":"final","title":"Final","keywords":[],"oneliner":"æ–‡æ›¸ã®çµ‚ã‚ã‚Šã§ã®çŠ¶æ…‹å€¤ã®å–å¾—ã€‚","element":false,"contextual":true,"deprecationMessage":null,"deprecationUntil":null,"details":[{"kind":"html","content":"<p>æ–‡æ›¸ã®çµ‚ã‚ã‚Šã§ã®çŠ¶æ…‹å€¤ã®å–å¾—ã€‚</p>"}],"self":true,"params":[],"returns":["any"],"scope":[]},{"path":["state"],"name":"update","title":"Update","keywords":[],"oneliner":"çŠ¶æ…‹å€¤ã‚’æ›´æ–°ã€‚","element":false,"contextual":false,"deprecationMessage":null,"deprecationUntil":null,"details":[{"kind":"html","content":"<p>çŠ¶æ…‹å€¤ã‚’æ›´æ–°ã€‚</p>\n<p>æ›´æ–°ã¯ã€è¿”ã‚Šå€¤ã§ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒæ–‡æ›¸ä¸­ã«æŒ¿å…¥ã•ã‚ŒãŸä½ç½®ã§é©ç”¨ã•ã‚Œã¾ã™ã€‚\næ–‡æ›¸ä¸­ã«å‡ºåŠ›ãŒãªã‘ã‚Œã°ä½•ã‚‚èµ·ã“ã‚Šã¾ã›ã‚“ï¼\nä¾‹ãˆã°<code><span class=\"typ-key\">let</span> _ <span class=\"typ-op\">=</span> <span class=\"typ-func\">state</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;key&quot;</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">update</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">7</span><span class=\"typ-punct\">)</span></code>ã¨æ›¸ã„ãŸå ´åˆãŒã€ã“ã®ä½•ã‚‚èµ·ããªã„ã¨ãã«è©²å½“ã—ã¾ã™ã€‚\nçŠ¶æ…‹ã®æ›´æ–°ã¯å¸¸ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆé †ã«é©ç”¨ã•ã‚Œã‚‹ãŸã‚ã€ã“ã®å ´åˆã«ã¯Typstã¯ã„ã¤çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹ã®ã‹åˆ†ã‹ã‚Šã¾ã›ã‚“ã€‚</p>\n<p><a href=\"/docs/reference/introspection/state/#definitions-get\"><code>get</code></a>ã€<a href=\"/docs/reference/introspection/state/#definitions-at\"><code>at</code></a>ã€<a href=\"/docs/reference/introspection/state/#definitions-final\"><code>final</code></a>ã¨ã¯ç•°ãªã‚Šã€\nã“ã®é–¢æ•°ã¯<a href=\"/docs/reference/context/\">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</a>ã‚’å¿…è¦ã¨ã—ã¾ã›ã‚“ã€‚</p>"}],"self":true,"params":[{"name":"update","details":[{"kind":"html","content":"<p>æ›´æ–°ã«ä½¿ã†å€¤ã¾ãŸã¯é–¢æ•°ã€‚</p>\n<ul>\n<li>é–¢æ•°ã§ã¯ãªã„å€¤ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€çŠ¶æ…‹ã«ãã®å€¤ã‚’è¨­å®šã—ã¾ã™ã€‚</li>\n<li>é–¢æ•°ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€ãã®é–¢æ•°ã¯å‰ã®çŠ¶æ…‹ã‚’å—ã‘å–ã‚Šã€æ–°ã—ã„çŠ¶æ…‹ã‚’è¿”ã•ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</li>\n</ul>\n<p>ä»¥å‰ã®å€¤ã«åŸºã¥ã„ã¦æ›´æ–°ã™ã‚‹å ´åˆã¯ã€<a href=\"/docs/reference/context/\">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</a>ã‹ã‚‰\nä»¥å‰ã®å€¤ã‚’å–å¾—ã™ã‚‹ã‚ˆã‚Šã‚‚ã€é–¢æ•°å½¢å¼ã‚’ä½¿ã†ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\nã“ã‚Œã«ã‚ˆã‚Šã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒæœ€çµ‚çŠ¶æ…‹ã‚’åŠ¹ç‡è‰¯ãè§£æ±ºã§ãã€\nå¿…è¦ãª<a href=\"/docs/reference/context/#compiler-iterations\">ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåå¾©</a>å›æ•°ã‚’æŠ‘ãˆã‚‰ã‚Œã¾ã™ã€‚</p>\n<p>æ¬¡ã®ä¾‹ã§ã¯ã€<code>fill<span class=\"typ-punct\">.</span><span class=\"typ-func\">update</span><span class=\"typ-punct\">(</span>f <span class=\"typ-op\">=&gt;</span> <span class=\"typ-key\">not</span> f<span class=\"typ-punct\">)</span></code>ã¯æœŸå¾…é€šã‚Šã«\n<a href=\"/docs/reference/model/list/#definitions-item\">ç®‡æ¡æ›¸ãã®é …ç›®</a>ã®å¥‡æ•°è¡Œã‚’å¡—ã‚Šã¾ã™ã€‚\nã“ã‚Œã‚’<code><span class=\"typ-key\">context</span> fill<span class=\"typ-punct\">.</span><span class=\"typ-func\">update</span><span class=\"typ-punct\">(</span><span class=\"typ-key\">not</span> fill<span class=\"typ-punct\">.</span><span class=\"typ-func\">get</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">)</span></code>ã«ç½®ãæ›ãˆã‚‹ã¨ã€\nå„æ›´æ–°ãŒè¿½åŠ ã®åå¾©ã‚’å¿…è¦ã¨ã—ã€5å›ä»¥å†…ã«åæŸã—ã¾ã›ã‚“ã€‚</p>"},{"kind":"example","content":{"body":"<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> fill <span class=\"typ-op\">=</span> <span class=\"typ-func\">state</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;fill&quot;</span><span class=\"typ-punct\">,</span> <span class=\"typ-key\">false</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">show</span> list<span class=\"typ-punct\">.</span><span class=\"typ-func\">item</span><span class=\"typ-punct\">:</span> it <span class=\"typ-op\">=&gt;</span> <span class=\"typ-punct\">{</span>\n  fill<span class=\"typ-punct\">.</span><span class=\"typ-func\">update</span><span class=\"typ-punct\">(</span>f <span class=\"typ-op\">=&gt;</span> <span class=\"typ-key\">not</span> f<span class=\"typ-punct\">)</span>\n  <span class=\"typ-key\">context</span> <span class=\"typ-punct\">{</span>\n    <span class=\"typ-key\">set</span> <span class=\"typ-func\">text</span><span class=\"typ-punct\">(</span>fill<span class=\"typ-punct\">:</span> fuchsia<span class=\"typ-punct\">)</span> <span class=\"typ-key\">if</span> fill<span class=\"typ-punct\">.</span><span class=\"typ-func\">get</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n    it\n  <span class=\"typ-punct\">}</span>\n<span class=\"typ-punct\">}</span>\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">lorem</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">5</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">split</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">map</span><span class=\"typ-punct\">(</span>list<span class=\"typ-punct\">.</span>item<span class=\"typ-punct\">)</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">join</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/396ec1571afb7936e381da6ef57923c.png\" alt=\"Preview\"></div></div>","title":null}}],"types":["any","function"],"strings":[],"default":null,"positional":true,"named":false,"required":true,"variadic":false,"settable":false}],"returns":["content"],"scope":[]}]}}}