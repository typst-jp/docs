{"route":"/docs/tutorial/making-a-template/","title":"テンプレートを作成する","description":"Typstチュートリアル","part":null,"outline":[{"id":"variables","name":"Variables","children":[]},{"id":"toy-template","name":"Toy Template","children":[]},{"id":"set-and-show-rules","name":"Set And Show Rules","children":[]},{"id":"named-arguments","name":"Named Arguments","children":[]},{"id":"separate-file","name":"Separate File","children":[]},{"id":"review","name":"Review","children":[]}],"body":{"kind":"html","content":"<h1>テンプレートを作成する</h1>\n<p>このチュートリアルの前回の3つの章では、Typstでドキュメントを書く方法、基本的なスタイルを適用する方法、そして出版社のスタイルガイドに準拠するために外観を詳細にカスタマイズする方法を学びました。前章で作成した論文が大成功を収めたため、同じ会議のための続報論文を書くよう依頼されました。今回は、前章で作成したスタイルを再利用可能なテンプレートに変換したいと思います。この章では、あなたとあなたのチームが単一のshowルールで使用できるテンプレートの作成方法を学びます。始めましょう！</p>\n<h2 id=\"variables\">Reusing data with variables</h2>\n<p>In the past chapters, most of the content of the document was entered by hand.\nIn the third chapter, we used the <code>document</code> element and context to cut down on\nrepetition and only enter the title once. But in practice, there may be many\nmore things that occur multiple times in your document. There are multiple good\nreasons to just define these repeated values once:</p>\n<ol>\n<li>It makes changing them later easier</li>\n<li>It allows you to quickly find all instances where you used something</li>\n<li>It makes it easy to be consistent throughout</li>\n<li>For long or hard-to-enter repeated segments, a shorter variable name is often\nmore convenient to type</li>\n</ol>\n<p>If you were using a conventional word processor, you might resort to using a\nplaceholder value that you can later search for. In Typst, however, you can\ninstead use variables to safely store content and reuse it across your whole\ndocument through a variable name.</p>\n<p>The technique of using context to reproduce an element's property we have\nlearned earlier is not always the most appropriate for this: Typst's built-in\nelements focus on semantic properties like the title and description of a\ndocument, or things that directly relate to typesetting, like the text size.</p>\n<p>For our example, we want to take a look at Typst's pronunciation. One of the\nbest ways to transcribe pronunciation is the International Phonetic Alphabet\n(IPA). But because it uses characters not found on common keyboards, typing IPA\nrepeatedly can become cumbersome. So let's instead define a variable that we can\nreference multiple times.</p>\n<pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> ipa <span class=\"typ-op\">=</span> <span class=\"typ-punct\">[</span>taɪpst<span class=\"typ-punct\">]</span>\n</code></pre>\n<p>Here, we use a new keyword, <code><span class=\"typ-key\">let</span></code>, to indicate a variable definition. Then,\nwe put the name of our variable, in this case, <code>ipa</code>. Finally, we type an equals\nsign and the value of our variable. It is enclosed in square brackets because\nit is content, mirroring how you would call a function accepting content. In\nother words, this syntax mirrors the phrase <em>\"Let the variable <code>ipa</code> have the\nvalue <code><span class=\"typ-punct\">[</span>taɪpst<span class=\"typ-punct\">]</span></code>.\"</em></p>\n<p>Now, we can use the variable in our document:</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> ipa <span class=\"typ-op\">=</span> <span class=\"typ-punct\">[</span>taɪpst<span class=\"typ-punct\">]</span>\n\nThe canonical way to\npronounce Typst is <span class=\"typ-pol\">#</span><span class=\"typ-pol\">ipa</span>.\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">table</span><span class=\"typ-punct\">(</span>\n  columns<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">(</span><span class=\"typ-num\">1fr</span><span class=\"typ-punct\">,</span> <span class=\"typ-num\">1fr</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  <span class=\"typ-punct\">[</span>Name<span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span> <span class=\"typ-punct\">[</span>Typst<span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span>\n  <span class=\"typ-punct\">[</span>Pronunciation<span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span> ipa<span class=\"typ-punct\">,</span>\n<span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/1a33d218e9ec4ec2b683baca85e512e7.png\" alt=\"Preview\"></div></div>\n<p>In the example, you can see that the variable can be used both in markup\n(prefixed with a <code>#</code>) and in a function call (by just typing its name). Of\ncourse, we can change the value of the variable and all its occurrences will\nautomatically change with it. Let's make it a bit clearer what is IPA and what\nis normal prose by rendering IPA in italics. We are also using slashes which, by\nconvention, often enclose IPA.</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> ipa <span class=\"typ-op\">=</span> <span class=\"typ-func\">text</span><span class=\"typ-punct\">(</span>\n  style<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;italic&quot;</span><span class=\"typ-punct\">,</span>\n<span class=\"typ-punct\">)</span><span class=\"typ-punct\">[</span>/taɪpst/<span class=\"typ-punct\">]</span>\n\nThe canonical way to\npronounce Typst is <span class=\"typ-pol\">#</span><span class=\"typ-pol\">ipa</span>.\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">table</span><span class=\"typ-punct\">(</span>\n  columns<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">(</span><span class=\"typ-num\">1fr</span><span class=\"typ-punct\">,</span> <span class=\"typ-num\">1fr</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  <span class=\"typ-punct\">[</span>Name<span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span> <span class=\"typ-punct\">[</span>Typst<span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span>\n  <span class=\"typ-punct\">[</span>Pronunciation<span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span> ipa<span class=\"typ-punct\">,</span>\n<span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/ef87ca8429247c40169a6c3d07584d47.png\" alt=\"Preview\"></div></div>\n<p>Here, we called the text function and assigned its <em>return value</em> to the\nvariable. When you call a function, it processes its arguments and then yields\nanother value (often content). So far in this tutorial, we called most\nfunctions directly in markup, like this: <code><span class=\"typ-func\">#</span><span class=\"typ-func\">text</span><span class=\"typ-punct\">(</span>fill<span class=\"typ-punct\">:</span> red<span class=\"typ-punct\">)</span><span class=\"typ-punct\">[</span>CRIMSON!<span class=\"typ-punct\">]</span></code>. This\ncall to the text function returns the red text as a return value. Because we\nplaced it in markup, its return value just immediately got inserted into the\ncontent we wrote. With variables, we can instead store it to use it later or\ncompose it with other values.</p>\n<p>Variables are not limited to storing content: they can store any data type Typst\nknows about. Throughout this tutorial, you made use of many data types when you\npassed them to Typst's built-in functions. Here is an example assigning each of\nthem to a variable:</p>\n<pre><code><span class=\"typ-comment\">// Content with markup inside</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> blind-text <span class=\"typ-op\">=</span> <span class=\"typ-punct\">[</span><span class=\"typ-emph\">_Lorem ipsum_</span> dolor sit amet<span class=\"typ-punct\">]</span>\n\n<span class=\"typ-comment\">// Unformatted strings</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> funny-font <span class=\"typ-op\">=</span> <span class=\"typ-str\">&quot;MS Comic Sans&quot;</span>\n\n<span class=\"typ-comment\">// Absolute lengths (see also pt, in, ...)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> mile <span class=\"typ-op\">=</span> <span class=\"typ-num\">160934cm</span>\n\n<span class=\"typ-comment\">// Lengths relative to the font size</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> double-space <span class=\"typ-op\">=</span> <span class=\"typ-num\">2em</span>\n\n<span class=\"typ-comment\">// Ratios</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> progress <span class=\"typ-op\">=</span> <span class=\"typ-num\">80%</span>\n\n<span class=\"typ-comment\">// Integer numbers</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> answer <span class=\"typ-op\">=</span> <span class=\"typ-num\">42</span>\n\n<span class=\"typ-comment\">// Booleans</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> truth <span class=\"typ-op\">=</span> <span class=\"typ-key\">false</span>\n\n<span class=\"typ-comment\">// Horizontal and vertical alignment</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> focus <span class=\"typ-op\">=</span> center\n</code></pre>\n<p>In this chapter of the tutorial, you will leverage variables and your own\nfunctions to build templates that can be reused across multiple documents.</p>\n<h2 id=\"toy-template\">簡易テンプレート</h2>\n<p>Typstでは、テンプレートは文書全体をラップできる関数です。その方法を学ぶために、まずは独自の関数の書き方を復習しましょう。関数は何でもできるので、少し奇抜なものを作ってみませんか？</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">amazed</span><span class=\"typ-punct\">(</span>term<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-func\">box</span><span class=\"typ-punct\">[</span>✨ <span class=\"typ-pol\">#</span><span class=\"typ-pol\">term</span> ✨<span class=\"typ-punct\">]</span>\n\nYou are <span class=\"typ-func\">#</span><span class=\"typ-func\">amazed</span><span class=\"typ-punct\">[</span>beautiful<span class=\"typ-punct\">]</span>!\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/85ffb432ec9336d10dbea32ea93e4896.png\" alt=\"Preview\"></div></div>\n<p>Comparing this against the previous section, you may have noticed that this\nlooks a lot like a variable definition using <code><span class=\"typ-key\">let</span></code>. This instinct is correct:\nFunctions are just another data type. Here, we are defining the variable\n<code>amazed</code>, assigning it a function that takes a single argument, <code>term</code>, and\nreturns content with the <code>term</code> surrounded by sparkles. We also put the whole\nthing in a <a href=\"/docs/reference/layout/box/\"><code>box</code></a> so that the term we are amazed by cannot be separated from\nits sparkles by a line break. The special function definition syntax makes the\ndefinition shorter and more readable, but you can also use the regular variable\ndefinition syntax (see <a href=\"/docs/reference/scripting/#bindings\">the scripting reference</a> for\ndetails). After its definition, we are able to call the function just like all\nbuilt-in functions.</p>\n<p>Many functions that come with Typst have optional named parameters. Our\nfunctions can also have them. Let's add a parameter to our function that lets us\nchoose the color of the text. We need to provide a default color in case the\nparameter isn't given.</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">amazed</span><span class=\"typ-punct\">(</span>term<span class=\"typ-punct\">,</span> color<span class=\"typ-punct\">:</span> blue<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-punct\">{</span>\n  <span class=\"typ-func\">text</span><span class=\"typ-punct\">(</span>color<span class=\"typ-punct\">,</span> <span class=\"typ-func\">box</span><span class=\"typ-punct\">[</span>✨ <span class=\"typ-pol\">#</span><span class=\"typ-pol\">term</span> ✨<span class=\"typ-punct\">]</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-punct\">}</span>\n\nYou are <span class=\"typ-func\">#</span><span class=\"typ-func\">amazed</span><span class=\"typ-punct\">[</span>beautiful<span class=\"typ-punct\">]</span>!\nI am <span class=\"typ-func\">#</span><span class=\"typ-func\">amazed</span><span class=\"typ-punct\">(</span>color<span class=\"typ-punct\">:</span> purple<span class=\"typ-punct\">)</span><span class=\"typ-punct\">[</span>amazed<span class=\"typ-punct\">]</span>!\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/de3b1f5b9b2c4f6a9672c242956d317.png\" alt=\"Preview\"></div></div>\n<p>テンプレートは<code>amazed</code>のようなカスタム関数でドキュメント全体をラップすることで機能します。しかし、文書全体を巨大な関数呼び出しでラップするのは面倒でしょう！代わりに、「everything」showルールを使用して、より洗練されたコードで同じことを実現できます。そのようなshowルールを書くには、showキーワードの直後にコロンを置き、関数を提供します。この関数にはドキュメントの残りの部分がパラメータとして渡されます。関数はこのコンテンツに対して何でも行うことができます。<code>amazed</code>関数は単一のコンテンツ引数で呼び出せるので、showルールに名前で渡すだけで良いのです。試してみましょう。</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">show</span><span class=\"typ-punct\">:</span> <span class=\"typ-func\">amazed</span>\nI choose to focus on the good\nin my life and let go of any\nnegative thoughts or beliefs.\nIn fact, I am amazing!\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/808bff8bf2db750d153f0acbf0b0fbf1.png\" alt=\"Preview\"></div></div>\n<p>これで文書全体が<code>amazed</code>関数に渡され、文書をその関数でラップしたかのように機能します。もちろん、この特定の関数ではあまり有用ではありませんが、setルールと名前付き引数と組み合わせると、非常に強力になります。</p>\n<h2 id=\"set-and-show-rules\">setルールとshowルールの埋め込み</h2>\n<p>テンプレートにいくつかのsetルールとshowルールを適用するには、関数内のコンテンツブロックで<code>set</code>と<code>show</code>を使用し、そのコンテンツブロックにドキュメントを挿入します。</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">template</span><span class=\"typ-punct\">(</span>doc<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-punct\">[</span>\n  <span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">text</span><span class=\"typ-punct\">(</span>font<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Inria Serif&quot;</span><span class=\"typ-punct\">)</span>\n  <span class=\"typ-key\">#</span><span class=\"typ-key\">show</span> <span class=\"typ-str\">&quot;something cool&quot;</span><span class=\"typ-punct\">:</span> <span class=\"typ-punct\">[</span>Typst<span class=\"typ-punct\">]</span>\n  <span class=\"typ-pol\">#</span><span class=\"typ-pol\">doc</span>\n<span class=\"typ-punct\">]</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">show</span><span class=\"typ-punct\">:</span> <span class=\"typ-func\">template</span>\nI am learning something cool today.\nIt&#39;s going great so far!\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/3e1c39dbdd957964b7524749bf0cfd5.png\" alt=\"Preview\"></div></div>\n<p>前章で発見したように、setルールはそのコンテンツブロック内の全てに適用されます。everythingのshowルールが文書全体を<code>template</code>関数に渡すため、テンプレート内のテキストのsetルールと文字列のshowルールが文書全体に適用されます。この知識を使って、前章で作成した論文の本文スタイルを再現するテンプレートを作成しましょう。</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">conf</span><span class=\"typ-punct\">(</span>title<span class=\"typ-punct\">,</span> doc<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-punct\">{</span>\n  <span class=\"typ-key\">set</span> <span class=\"typ-func\">page</span><span class=\"typ-punct\">(</span>\n    paper<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;us-letter&quot;</span><span class=\"typ-punct\">,</span>\n    header<span class=\"typ-punct\">:</span> <span class=\"typ-func\">align</span><span class=\"typ-punct\">(</span>\n      right <span class=\"typ-op\">+</span> horizon<span class=\"typ-punct\">,</span>\n      title\n    <span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n    columns<span class=\"typ-punct\">:</span> <span class=\"typ-num\">2</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-op\">..</span><span class=\"typ-punct\">.</span>\n  <span class=\"typ-punct\">)</span>\n  <span class=\"typ-key\">set</span> <span class=\"typ-func\">par</span><span class=\"typ-punct\">(</span>justify<span class=\"typ-punct\">:</span> <span class=\"typ-key\">true</span><span class=\"typ-punct\">)</span>\n  <span class=\"typ-key\">set</span> <span class=\"typ-func\">text</span><span class=\"typ-punct\">(</span>\n    font<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Libertinus Serif&quot;</span><span class=\"typ-punct\">,</span>\n    size<span class=\"typ-punct\">:</span> <span class=\"typ-num\">11pt</span><span class=\"typ-punct\">,</span>\n  <span class=\"typ-punct\">)</span>\n\n  <span class=\"typ-comment\">// Heading show rules.</span>\n  ...\n\n  doc\n<span class=\"typ-punct\">}</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">show</span><span class=\"typ-punct\">:</span> doc <span class=\"typ-op\">=&gt;</span> <span class=\"typ-func\">conf</span><span class=\"typ-punct\">(</span>\n  <span class=\"typ-punct\">[</span>Paper title<span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span>\n  doc<span class=\"typ-punct\">,</span>\n<span class=\"typ-punct\">)</span>\n\n<span class=\"typ-heading\">= Introduction</span>\n<span class=\"typ-escape\">...</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/400d52d31bee3faf506dfff0afe445fc.png\" alt=\"Preview\"></div></div>\n<p>コードの大部分は前章からコピーペーストしました。2つの違いがあります。</p>\n<ol>\n<li>\n<p>everythingのshowルールを使用して、全てを<code>conf</code>関数でラップしました。この関数はいくつかのsetルールとshowルールを適用し、最後に渡されたコンテンツをそのまま出力します。</p>\n</li>\n<li>\n<p>さらに、コンテンツブロックの代わりに中括弧で囲まれたコードブロックを使用しました。この方法では、全てのsetルールや関数呼び出しの前に<code>#</code>を付ける必要がなくなります。代わりに、コードブロック内に直接マークアップを書くことはできなくなります。</p>\n</li>\n</ol>\n<p>また、タイトルがどこから来ているかに注目してください。以前は変数に格納しましたが、今はテンプレート関数の最初のパラメータとして受け取っています。そのために、everythingのshowルールにクロージャー（その場で使用される名前のない関数）を渡しました。<code>conf</code>関数は2つの引数（タイトルと本文）を期待しますが、showルールは本文のみを渡すからです。したがって、論文のタイトルを設定し、showルールからの単一パラメータを使用できる新しい関数定義を追加します。</p>\n<h2 id=\"named-arguments\">名前付き引数を持つテンプレート</h2>\n<p>前章の論文にはタイトルと著者リストがありました。これらの要素をテンプレートに追加しましょう。タイトルに加えて、所属機関を含む著者リストと論文の要約をテンプレートに受け付けるようにします。可読性を保つために、これらを名前付き引数として追加します。最終的には、次のように機能させたいと思います。</p>\n<pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">show</span><span class=\"typ-punct\">:</span> doc <span class=\"typ-op\">=&gt;</span> <span class=\"typ-func\">conf</span><span class=\"typ-punct\">(</span>\n  title<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">[</span>\n    A Fluid Dynamic Model for\n    Glacier Flow\n  <span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span>\n  authors<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">(</span>\n    <span class=\"typ-punct\">(</span>\n      name<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Theresa Tungsten&quot;</span><span class=\"typ-punct\">,</span>\n      affiliation<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Artos Institute&quot;</span><span class=\"typ-punct\">,</span>\n      email<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;tung@artos.edu&quot;</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-punct\">(</span>\n      name<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Eugene Deklan&quot;</span><span class=\"typ-punct\">,</span>\n      affiliation<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Honduras State&quot;</span><span class=\"typ-punct\">,</span>\n      email<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;e.deklan@hstate.hn&quot;</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  <span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  abstract<span class=\"typ-punct\">:</span> <span class=\"typ-func\">lorem</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">80</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  doc<span class=\"typ-punct\">,</span>\n<span class=\"typ-punct\">)</span>\n\n<span class=\"typ-escape\">...</span>\n</code></pre>\n<p>この新しいテンプレート関数を構築しましょう。まず、<code>title</code>引数にデフォルト値を追加します。これにより、タイトルを指定せずにテンプレートを呼び出すことができます。また、空のデフォルト値を持つ名前付き引数として<code>authors</code>および<code>abstract</code>パラメータを追加します。次に、前章からタイトル、要約、著者を生成するコードをテンプレートにコピーし、固定の詳細をパラメータに置き換えます。</p>\n<p>新しい<code>authors</code>パラメータは、<code>name</code>、<code>affiliation</code>、<code>email</code>というキーを持つ<a href=\"/docs/reference/foundations/dictionary/\">辞書</a>の<a href=\"/docs/reference/foundations/array/\">配列</a>を想定しています。任意の数の著者を持つことができるため、著者リストに1列、2列、または3列が必要かどうかを動的に決定します。まず、<code>authors</code>配列の<a href=\"/docs/reference/foundations/array/#definitions-len\"><code>.len()</code></a>メソッドを使用して著者の数を決定します。次に、列数を著者数と3の最小値に設定し、3列以上作成しないようにします。3人以上の著者がいる場合は、代わりに新しい行が挿入されます。この目的のために、<code>grid</code>関数に<code>row-gutter</code>パラメータも追加しました。そうしないと、行同士が近すぎてしまいます。辞書から著者の詳細を抽出するには、<a href=\"/docs/reference/scripting/#fields\">フィールドアクセス構文</a>を使用します。</p>\n<p>各著者についてグリッドに引数を提供する必要があります。ここで配列の<a href=\"/docs/reference/foundations/array/#definitions-map\"><code>map</code>メソッド</a>が便利です。これは引数として関数を取り、その関数が配列の各アイテムで呼び出されます。各著者の詳細をフォーマットし、コンテンツ値を含む新しい配列を返す関数を渡します。これで、グリッドの複数の引数として使用したい値の配列ができました。<a href=\"/docs/reference/foundations/arguments/\"><code>spread</code>演算子</a>を使用してこれを実現できます。これは配列を取り、その各アイテムを関数の個別の引数として適用します。</p>\n<p>結果のテンプレート関数は次のようになります。</p>\n<pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">let</span> <span class=\"typ-func\">conf</span><span class=\"typ-punct\">(</span>\n  title<span class=\"typ-punct\">:</span> <span class=\"typ-key\">none</span><span class=\"typ-punct\">,</span>\n  authors<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  abstract<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">[</span><span class=\"typ-punct\">]</span><span class=\"typ-punct\">,</span>\n  doc<span class=\"typ-punct\">,</span>\n<span class=\"typ-punct\">)</span> <span class=\"typ-op\">=</span> <span class=\"typ-punct\">{</span>\n  <span class=\"typ-comment\">// Set and show rules from before.</span>\n  ...\n\n  <span class=\"typ-func\">place</span><span class=\"typ-punct\">(</span>\n    top <span class=\"typ-op\">+</span> center<span class=\"typ-punct\">,</span>\n    float<span class=\"typ-punct\">:</span> <span class=\"typ-key\">true</span><span class=\"typ-punct\">,</span>\n    scope<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;parent&quot;</span><span class=\"typ-punct\">,</span>\n    clearance<span class=\"typ-punct\">:</span> <span class=\"typ-num\">2em</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-punct\">{</span>\n      <span class=\"typ-func\">title</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n\n      <span class=\"typ-key\">let</span> count <span class=\"typ-op\">=</span> authors<span class=\"typ-punct\">.</span><span class=\"typ-func\">len</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span>\n      <span class=\"typ-key\">let</span> ncols <span class=\"typ-op\">=</span> calc<span class=\"typ-punct\">.</span><span class=\"typ-func\">min</span><span class=\"typ-punct\">(</span>count<span class=\"typ-punct\">,</span> <span class=\"typ-num\">3</span><span class=\"typ-punct\">)</span>\n      <span class=\"typ-func\">grid</span><span class=\"typ-punct\">(</span>\n        columns<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">(</span><span class=\"typ-num\">1fr</span><span class=\"typ-punct\">,</span><span class=\"typ-punct\">)</span> <span class=\"typ-op\">*</span> ncols<span class=\"typ-punct\">,</span>\n        row-gutter<span class=\"typ-punct\">:</span> <span class=\"typ-num\">24pt</span><span class=\"typ-punct\">,</span>\n        <span class=\"typ-op\">..</span>authors<span class=\"typ-punct\">.</span><span class=\"typ-func\">map</span><span class=\"typ-punct\">(</span>author <span class=\"typ-op\">=&gt;</span> <span class=\"typ-punct\">[</span>\n          <span class=\"typ-pol\">#</span><span class=\"typ-pol\">author</span><span class=\"typ-punct\">.</span><span class=\"typ-pol\">name</span> <span class=\"typ-escape\">\\</span>\n          <span class=\"typ-pol\">#</span><span class=\"typ-pol\">author</span><span class=\"typ-punct\">.</span><span class=\"typ-pol\">affiliation</span> <span class=\"typ-escape\">\\</span>\n          <span class=\"typ-func\">#</span><span class=\"typ-func\">link</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;mailto:&quot;</span> <span class=\"typ-op\">+</span> author<span class=\"typ-punct\">.</span>email<span class=\"typ-punct\">)</span>\n        <span class=\"typ-punct\">]</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n      <span class=\"typ-punct\">)</span>\n\n      <span class=\"typ-func\">par</span><span class=\"typ-punct\">(</span>justify<span class=\"typ-punct\">:</span> <span class=\"typ-key\">false</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">[</span>\n        <span class=\"typ-strong\">*Abstract*</span> <span class=\"typ-escape\">\\</span>\n        <span class=\"typ-pol\">#</span><span class=\"typ-pol\">abstract</span>\n      <span class=\"typ-punct\">]</span>\n\n    <span class=\"typ-punct\">}</span>\n  <span class=\"typ-punct\">)</span>\n\n  doc\n<span class=\"typ-punct\">}</span>\n</code></pre>\n<h2 id=\"separate-file\">別ファイル</h2>\n<p>多くの場合、テンプレートは別のファイルで指定され、それからドキュメントにインポートされます。この方法では、メインファイルはすっきりとし、テンプレートを簡単に再利用できます。ファイルパネルでプラスボタンをクリックして新しいテキストファイルを作成し、<code>conf.typ</code>という名前を付けます。<code>conf</code>関数定義をその新しいファイルに移動します。これで、showルールの前にインポートを追加することで、メインファイルからアクセスできます。<code><span class=\"typ-key\">import</span></code>キーワードとコロンの間にファイルのパスを指定し、インポートしたい関数に名前を付けます。</p>\n<p>テンプレートの適用をより洗練させるためにできるもう1つのことは、関数の<a href=\"/docs/reference/foundations/function/#definitions-with\"><code>.with</code></a>メソッドを使用して、全ての名前付き引数を事前に設定することです。これにより、クロージャーを記述してテンプレートリストの最後にコンテンツ引数を追加する必要がなくなります。<a href=\"https://typst.app/universe/\">Typst Universe</a>のテンプレートは、この関数呼び出しのスタイルで動作するように設計されています。</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">import</span> <span class=\"typ-str\">&quot;conf.typ&quot;</span><span class=\"typ-punct\">:</span> conf\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">document</span><span class=\"typ-punct\">(</span>title<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">[</span>\n  A Fluid Dynamic Model for\n  Glacier Flow\n<span class=\"typ-punct\">]</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">show</span><span class=\"typ-punct\">:</span> conf<span class=\"typ-punct\">.</span><span class=\"typ-func\">with</span><span class=\"typ-punct\">(</span>\n  authors<span class=\"typ-punct\">:</span> <span class=\"typ-punct\">(</span>\n    <span class=\"typ-punct\">(</span>\n      name<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Theresa Tungsten&quot;</span><span class=\"typ-punct\">,</span>\n      affiliation<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Artos Institute&quot;</span><span class=\"typ-punct\">,</span>\n      email<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;tung@artos.edu&quot;</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-punct\">(</span>\n      name<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Eugene Deklan&quot;</span><span class=\"typ-punct\">,</span>\n      affiliation<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;Honduras State&quot;</span><span class=\"typ-punct\">,</span>\n      email<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;e.deklan@hstate.hn&quot;</span><span class=\"typ-punct\">,</span>\n    <span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  <span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n  abstract<span class=\"typ-punct\">:</span> <span class=\"typ-func\">lorem</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">80</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span>\n<span class=\"typ-punct\">)</span>\n\n<span class=\"typ-heading\">= Introduction</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">lorem</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">90</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-heading\">== Motivation</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">lorem</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">140</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-heading\">== Problem Statement</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">lorem</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">50</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-heading\">= Related Work</span>\n<span class=\"typ-func\">#</span><span class=\"typ-func\">lorem</span><span class=\"typ-punct\">(</span><span class=\"typ-num\">200</span><span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/ce3f3a18593a1c2ac64ee6bee62da151.png\" alt=\"Preview\"></div></div>\n<p>これで会議論文を、その会議用の再利用可能なテンプレートに変換しました！<a href=\"https://forum.typst.app/\">フォーラム</a>や<a href=\"https://discord.gg/2uDybryKPe\">TypstのDiscordサーバー</a>で共有して、他の人も使えるようにしてみてはいかがでしょうか？</p>\n<h2 id=\"review\">まとめ</h2>\n<p>おめでとうございます！Typstのチュートリアルを完了しました。このセクションでは、独自の関数を定義する方法と、再利用可能なドキュメントスタイルを定義するテンプレートを作成・適用する方法を学びました。あなたは多くを学び、ここまで来ました。これでTypstを使用して独自の文書を作成し、他の人と共有することができます。</p>\n<p>私たちはまだ非常に若いプロジェクトであり、フィードバックを求めています。質問、提案、またはバグを発見した場合は、<a href=\"https://forum.typst.app/\">フォーラム</a>、<a href=\"https://discord.gg/2uDybryKPe\">Discordサーバー</a>、<a href=\"https://github.com/typst/typst/\">GitHub</a>、またはウェブアプリのフィードバックフォーム（ヘルプメニューからいつでも利用可能）でお知らせください。</p>\n<p>さっそく<a href=\"https://typst.app\">サインアップ</a>して何か書いてみましょう！</p>"}}